# Literature Manager

> Automated academic PDF organization with LLM-powered categorization and Zotero integration

A command-line tool for researchers that automatically extracts metadata, assigns topics, generates finding-focused summaries, and organizes academic papers into a searchable library.

## Overview

Literature Manager solves the academic paper organization problem through:

1. **Automated metadata extraction** from DOIs, PDF metadata, or LLM parsing
2. **Fixed taxonomy categorization** using a customizable 51-topic research taxonomy
3. **Finding-focused summaries** (6-8 words) generated by LLM
4. **Multi-topic assignment** for interdisciplinary papers
5. **Zotero integration** with automatic sync and collection management

**Designed for soil scientists and biogeochemists**, but easily adaptable to any research domain by customizing the taxonomy.

## Key Features

### Intelligent Processing
- **Triple-fallback metadata extraction**: DOI lookup → PDF metadata → LLM parsing
- **Abstract recovery**: Extracts abstracts from PDF text when DOI lacks them
- **Smart duplicate detection**: Checks DOI/title before expensive LLM calls
- **97% extraction success rate** on scientific PDFs

### Research-Backed Organization
- **Fixed taxonomy**: 51 predefined topics prevent categorization drift
- **Evidence-based summaries**: Finding-focused statements (not questions)
- **2-topic default**: Captures interdisciplinary nature of modern research
- **Topic validation**: Invalid LLM suggestions automatically flagged

### Production-Ready Automation
- **Background service**: macOS launchd integration for hands-free operation
- **Index auto-validation**: Repairs file path mismatches automatically
- **Zotero auto-sync**: Uploads with metadata, PDFs, collections, and tags
- **Low resource usage**: ~25 MB RAM idle, ~0.1% CPU

## Installation

### Prerequisites

- Python 3.9+
- [Anthropic API key](https://console.anthropic.com/settings/keys)
- (Optional) [Zotero account](https://www.zotero.org/) for sync features

### Quick Start

```bash
# Clone repository
git clone https://github.com/yourusername/literature-manager.git
cd literature-manager

# Install package
pip install -e .

# Set up configuration
cp config.yaml.example config.yaml
# Edit config.yaml with your paths

# Set up environment variables
cp ../.env.example ../.env
# Add your API keys to ../.env

# Create directory structure
mkdir -p ~/Desktop/workshop/workspace/inbox
mkdir -p ~/Desktop/workshop/library/literature/by-topic

# Test installation
literature-manager --help
```

### Background Service (macOS)

For fully automated processing:

```bash
./install_background_service.sh
```

This installs a launchd service that:
- Starts automatically on login
- Monitors inbox continuously
- Processes papers immediately
- Runs with low priority (won't slow your system)

**View logs:**
```bash
tail -f logs/watch.log        # Processing activity
tail -f logs/watch.error.log  # Errors only
```

## Usage

### Basic Workflow

**1. Add papers to inbox:**
```bash
# Download papers to inbox
cp ~/Downloads/*.pdf ~/Desktop/workshop/workspace/inbox/

# Or set your browser download location to inbox
```

**2. Process automatically** (if background service installed):
- Papers are detected and processed within seconds
- No manual intervention needed

**Or process manually:**
```bash
literature-manager process
```

**3. Find your papers:**
```bash
# Browse by topic
cd ~/Desktop/workshop/library/literature/by-topic/
ls soil-carbon/
ls maom/

# Or check recent papers
ls ~/Desktop/workshop/library/literature/recent/
```

### Example Output

**Input:** `10.1038_s41586-021-03306-8.pdf`

**System automatically:**
1. Extracts DOI → looks up metadata from CrossRef
2. Gets: *"Mineral protection regulates long-term global preservation of soil organic carbon"*
3. LLM generates summary: *"Mineral Protection Preserves Long-Term Soil Carbon"*
4. Assigns topics: `maom`, `stabilization-mechanisms`
5. Renames: `Hemingway et al., 2019 - Mineral Protection Preserves Long-Term Soil Carbon.pdf`
6. Files to: `by-topic/maom/` (+ symlink in `stabilization-mechanisms/`)
7. Uploads to Zotero in both collections

**Total time:** 3-5 seconds
**Cost:** ~$0.001 (if abstract extraction needed)

## Configuration

### Topic Taxonomy

The system uses a fixed taxonomy defined in `topics.yml`:

```yaml
topics:
  - slug: soil-carbon
    name: Soil Carbon
    category: soil-carbon-and-organic-matter
    description: Quantitative studies of soil carbon stocks, fluxes, and budgets
    keywords:
      - SOC
      - carbon stocks
      - sequestration
```

**51 topics across 7 categories:**
- Soil Carbon & Organic Matter (8)
- Analytical Methods (8)
- Biogeochemical Processes (8)
- Agricultural Systems (10)
- Environmental & Climate (7)
- Soil Properties & Processes (5)
- Social Science & Policy (5)

**To customize:** Edit `topics.yml` - no code changes needed.

### Zotero Integration

1. Get API credentials at https://www.zotero.org/settings/keys
2. Add to `../.env`:
   ```
   ZOTERO_API_KEY=your_key
   ZOTERO_USER_ID=your_id
   ```
3. Enable in `config.yaml`:
   ```yaml
   zotero_sync_enabled: true
   ```

**Features:**
- Auto-upload after processing
- Collections created for each topic
- Multi-topic papers appear in multiple collections
- Tags from assigned topics
- Finding summary in Extra field

## Architecture

### Processing Pipeline

```
PDF → DOI Extraction → CrossRef Lookup → Abstract Check →
LLM Enhancement → Topic Assignment → Duplicate Check →
File Organization → Zotero Upload
```

### Key Components

- **`extractors/`**: Metadata extraction (DOI, PDF, LLM)
- **`taxonomy.py`**: Fixed topic system with validation
- **`zotero_sync.py`**: Zotero API integration
- **`index_validator.py`**: Path repair and validation
- **`cli.py`**: Command-line interface and watch mode

## Performance

**Tested on 930 papers:**
- Metadata extraction: 97% success
- Abstract coverage: 96.7%
- Auto-categorization: 95.4%
- Processing speed: ~4 seconds/paper
- Total cost: ~$1.30 for full library

## Troubleshooting

### Papers fail to process
- Check if PDF is text-based (not scanned image)
- Verify DOI is present and formatted correctly
- Check API key is set in `../.env`

### Duplicate detection too aggressive
- Adjust threshold in `operations.py` (default 0.90)
- Lower to 0.85 for more tolerance

### Zotero upload fails
- Check storage quota (free accounts: 300 MB)
- Verify API key has file upload permissions
- Check collection creation permissions

### Background service not running
- Check status: `launchctl list | grep literature`
- View logs: `cat logs/watch.error.log`
- Restart: `launchctl kickstart -k gui/$(id -u)/com.samleuthold.literature-manager`

## Development

### Project Structure

```
literature-manager/
├── src/literature_manager/
│   ├── cli.py                    # CLI commands
│   ├── config.py                 # Configuration management
│   ├── taxonomy.py               # Fixed topic system
│   ├── zotero_sync.py            # Zotero integration
│   ├── index_validator.py        # Path validation
│   ├── operations.py             # File operations
│   ├── naming.py                 # Filename generation
│   └── extractors/
│       ├── orchestrator.py       # Coordinates extraction
│       ├── doi.py                # DOI + CrossRef
│       ├── pdf_metadata.py       # PDF metadata
│       ├── text_parser.py        # Text extraction
│       └── llm.py                # LLM parsing & enhancement
├── topics.yml                    # Research taxonomy
├── config.yaml.example           # Example configuration
├── install_background_service.sh # macOS service installer
└── archive/                      # Migration scripts & docs
```

### Running Tests

```bash
pytest tests/ -v
pytest tests/ --cov=literature_manager
```

### Contributing

Contributions welcome! Areas for improvement:
- Additional taxonomy domains (medicine, engineering, etc.)
- Alternative LLM providers (OpenAI, local models)
- Linked file support for Zotero
- Windows/Linux background service support

## License

MIT License - see [LICENSE](LICENSE) file

## Acknowledgments

Built with:
- [pyzotero](https://github.com/urschrei/pyzotero) - Zotero API client
- [Anthropic Claude](https://www.anthropic.com/) - LLM processing
- [pdfplumber](https://github.com/jsvine/pdfplumber) - PDF text extraction
- [watchdog](https://github.com/gorakhargosh/watchdog) - File system monitoring

---

**Version:** 2.0.0
**Status:** Production
**Last Updated:** 2025-10-25
